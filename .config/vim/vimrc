""" head
let s:state_dir = $HOME .. '/.local/state/vim'

let &viminfofile = s:state_dir .. '/viminfo'
let &directory   = s:state_dir .. '/swap//'
let &backupdir   = s:state_dir .. '/backup//'
let &undodir     = s:state_dir .. '/undo//'
let g:netrw_home = s:state_dir

call mkdir(fnamemodify(&viminfofile, ':p:h'), 'p')
call mkdir(expand(&directory), 'p')
call mkdir(expand(&backupdir), 'p')
call mkdir(expand(&undodir), 'p')
call mkdir(expand(g:netrw_home), 'p')

source ~/.config/vim/defaults.vim

""" file
set undofile
set autoread
set hidden

""" edit
set nowrap
set breakindent
set list
set listchars=tab:\ \ ,trail:.,extends:~,precedes:~,nbsp:+
set virtualedit=block

""" indent
set shiftwidth=4
set softtabstop=-1
set expandtab
set autoindent
set smartindent

""" move
set sidescrolloff=5
set sidescroll=1

""" search
set hlsearch
set ignorecase
set smartcase

""" screen
set signcolumn=number
set background=dark

let &t_EI = "\e[2 q"
let &t_SR = "\e[4 q"
let &t_SI = "\e[6 q"

""" keymap
nnoremap <silent> <C-L> <C-L><Cmd>nohlsearch<CR>

""" package
packadd! vim-oscyank
let g:oscyank_silent = 1
if (!has('clipboard_working'))
    let s:VimOSCYankPostRegisters = ['', '+', '*']
    let s:VimOSCYankOperators = ['y', 'd']
    function! s:VimOSCYankPostCallback(event)
        if index(s:VimOSCYankPostRegisters, a:event.regname) != -1
            \ && index(s:VimOSCYankOperators, a:event.operator) != -1
            call OSCYankRegister(a:event.regname)
        endif
    endfunction
    augroup VimOSCYankPost
        autocmd!
        autocmd TextYankPost * call s:VimOSCYankPostCallback(v:event)
    augroup END
endif
